#!/usr/bin/env python3

#
# Copyright (C) 2024 Nethesis S.r.l.
# SPDX-License-Identifier: GPL-3.0-or-later
#

import json
import sys

request = json.load(sys.stdin)

# write list to json file, will be used by UI
open("dns-records.json", "w").write(json.dumps(request))

with open("dnsmasq.d/01dns-records.conf", "w") as file:
    file.write("# This file is automatically generated by NethServer, manual changes will be lost.\n")
    for record in request["records"]:
        file.write("address=/" + record["domain"] + "/" + record["address"] + "\n")
